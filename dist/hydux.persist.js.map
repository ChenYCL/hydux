{"version":3,"sources":["webpack:///webpack/universalModuleDefinition","webpack:///hydux.persist.js","webpack:///webpack/bootstrap 6cb47aee12171796647f","webpack:///./src/cmd.ts","webpack:///./src/enhancers/persist.ts"],"names":["root","factory","exports","module","define","amd","self","this","modules","__webpack_require__","moduleId","installedModules","i","l","call","m","c","d","name","getter","o","Object","defineProperty","configurable","enumerable","get","n","__esModule","object","property","prototype","hasOwnProperty","p","s","1","value","default","none","ofPromise","task","args","succeedAction","failedAction","_","then","catch","ofFn","result","e","ofSub","sub","batch","cmds","_i","arguments","length","_concat","Array","concat","apply","map","cmd","actions","17","withPersist","props","timer","_a","store","localStorage","_b","serialize","JSON","stringify","_c","deserialize","parse","_d","debounce","_e","key","app","__assign","init","cmd_1","persistState","getItem","onUpdate","data","clearTimeout","persist","setItem","nextAppState","setTimeout","assign","t"],"mappings":"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","file":"hydux.persist.js","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"persist\"] = factory();\n\telse\n\t\troot[\"hydux\"] = root[\"hydux\"] || {}, root[\"hydux\"][\"persist\"] = factory();\n})(typeof self !== 'undefined' ? self : this, function() {\nreturn \n\n\n// WEBPACK FOOTER //\n// webpack/universalModuleDefinition","(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"persist\"] = factory();\n\telse\n\t\troot[\"hydux\"] = root[\"hydux\"] || {}, root[\"hydux\"][\"persist\"] = factory();\n})(typeof self !== 'undefined' ? self : this, function() {\nreturn /******/ (function(modules) { // webpackBootstrap\n/******/ \t// The module cache\n/******/ \tvar installedModules = {};\n/******/\n/******/ \t// The require function\n/******/ \tfunction __webpack_require__(moduleId) {\n/******/\n/******/ \t\t// Check if module is in cache\n/******/ \t\tif(installedModules[moduleId]) {\n/******/ \t\t\treturn installedModules[moduleId].exports;\n/******/ \t\t}\n/******/ \t\t// Create a new module (and put it into the cache)\n/******/ \t\tvar module = installedModules[moduleId] = {\n/******/ \t\t\ti: moduleId,\n/******/ \t\t\tl: false,\n/******/ \t\t\texports: {}\n/******/ \t\t};\n/******/\n/******/ \t\t// Execute the module function\n/******/ \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n/******/\n/******/ \t\t// Flag the module as loaded\n/******/ \t\tmodule.l = true;\n/******/\n/******/ \t\t// Return the exports of the module\n/******/ \t\treturn module.exports;\n/******/ \t}\n/******/\n/******/\n/******/ \t// expose the modules object (__webpack_modules__)\n/******/ \t__webpack_require__.m = modules;\n/******/\n/******/ \t// expose the module cache\n/******/ \t__webpack_require__.c = installedModules;\n/******/\n/******/ \t// define getter function for harmony exports\n/******/ \t__webpack_require__.d = function(exports, name, getter) {\n/******/ \t\tif(!__webpack_require__.o(exports, name)) {\n/******/ \t\t\tObject.defineProperty(exports, name, {\n/******/ \t\t\t\tconfigurable: false,\n/******/ \t\t\t\tenumerable: true,\n/******/ \t\t\t\tget: getter\n/******/ \t\t\t});\n/******/ \t\t}\n/******/ \t};\n/******/\n/******/ \t// getDefaultExport function for compatibility with non-harmony modules\n/******/ \t__webpack_require__.n = function(module) {\n/******/ \t\tvar getter = module && module.__esModule ?\n/******/ \t\t\tfunction getDefault() { return module['default']; } :\n/******/ \t\t\tfunction getModuleExports() { return module; };\n/******/ \t\t__webpack_require__.d(getter, 'a', getter);\n/******/ \t\treturn getter;\n/******/ \t};\n/******/\n/******/ \t// Object.prototype.hasOwnProperty.call\n/******/ \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n/******/\n/******/ \t// __webpack_public_path__\n/******/ \t__webpack_require__.p = \"\";\n/******/\n/******/ \t// Load entry module and return exports\n/******/ \treturn __webpack_require__(__webpack_require__.s = 17);\n/******/ })\n/************************************************************************/\n/******/ ({\n\n/***/ 1:\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nexports.default = {\r\n    none: [],\r\n    ofPromise: function (task, args, succeedAction, failedAction) {\r\n        return [\r\n            function (_) {\r\n                task(args)\r\n                    .then(succeedAction)\r\n                    .catch(failedAction);\r\n            }\r\n        ];\r\n    },\r\n    ofFn: function (task, args, succeedAction, failedAction) {\r\n        return [\r\n            function (_) {\r\n                try {\r\n                    var result = task(args);\r\n                    if (result && succeedAction) {\r\n                        succeedAction(result);\r\n                    }\r\n                }\r\n                catch (e) {\r\n                    failedAction && failedAction(e);\r\n                }\r\n            }\r\n        ];\r\n    },\r\n    ofSub: function (sub) {\r\n        return [sub];\r\n    },\r\n    batch: function () {\r\n        var cmds = [];\r\n        for (var _i = 0; _i < arguments.length; _i++) {\r\n            cmds[_i] = arguments[_i];\r\n        }\r\n        var _concat = Array.prototype.concat;\r\n        return _concat.apply([], _concat.apply([], cmds));\r\n    },\r\n    map: function (map, cmd) {\r\n        return cmd.map(function (sub) { return function (actions) { return sub(map(actions)); }; });\r\n    }\r\n};\r\n\n\n/***/ }),\n\n/***/ 17:\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\r\nvar __assign = (this && this.__assign) || Object.assign || function(t) {\r\n    for (var s, i = 1, n = arguments.length; i < n; i++) {\r\n        s = arguments[i];\r\n        for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\r\n            t[p] = s[p];\r\n    }\r\n    return t;\r\n};\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar cmd_1 = __webpack_require__(1);\r\nfunction withPersist(props) {\r\n    if (props === void 0) { props = {}; }\r\n    var _a = props.store, store = _a === void 0 ? localStorage : _a, _b = props.serialize, serialize = _b === void 0 ? JSON.stringify : _b, _c = props.deserialize, deserialize = _c === void 0 ? JSON.parse : _c, _d = props.debounce, debounce = _d === void 0 ? 50 : _d, _e = props.key, key = _e === void 0 ? 'hydux-persist' : _e;\r\n    var timer;\r\n    return function (app) { return function (props) {\r\n        return app(__assign({}, props, { init: function () {\r\n                var result = props.init();\r\n                if (!(result instanceof Array)) {\r\n                    result = [result, cmd_1.default.none];\r\n                }\r\n                var persistState = store.getItem(key);\r\n                if (persistState) {\r\n                    result[0] = deserialize(persistState);\r\n                }\r\n                return [result[0], result[1]];\r\n            }, onUpdate: function (data) {\r\n                props.onUpdate && props.onUpdate(data);\r\n                timer && clearTimeout(timer);\r\n                var persist = function () { return store.setItem(key, serialize(data.nextAppState)); };\r\n                timer = setTimeout(persist, debounce);\r\n            } }));\r\n    }; };\r\n}\r\nexports.default = withPersist;\r\n\n\n/***/ })\n\n/******/ });\n});\n\n\n// WEBPACK FOOTER //\n// hydux.persist.js"," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, {\n \t\t\t\tconfigurable: false,\n \t\t\t\tenumerable: true,\n \t\t\t\tget: getter\n \t\t\t});\n \t\t}\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 17);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap 6cb47aee12171796647f","import { ActionResult, ActionType, ActionsType } from './types'\n\nexport interface Sub<Actions> {\n  (actions: Actions): void\n}\nexport type CmdType<Actions> = Sub<Actions>[]\n\nexport default {\n  none: ([] as Array<Sub<any>>),\n  ofPromise<A, T, State, Actions>(\n    task: (args: A) => Promise<T>,\n    args: A,\n    succeedAction?: ActionType<T, State, Actions>,\n    failedAction?: ActionType<Error, State, Actions>\n  ): CmdType<Actions> {\n    return [\n      _ => {\n        task(args)\n        .then(succeedAction)\n        .catch(failedAction)\n      }\n    ]\n  },\n  ofFn<A, T, State, Actions>(\n    task: (args: A) => T | void,\n    args: A,\n    succeedAction?: ActionType<T, State, Actions>,\n    failedAction?: ActionType<Error, State, Actions>\n  ): CmdType<Actions> {\n    return [\n      _ => {\n        try {\n          let result = task(args)\n          if (result && succeedAction) {\n            succeedAction(result)\n          }\n        } catch (e) {\n          failedAction && failedAction(e)\n        }\n      }\n    ]\n  },\n  ofSub<Actions>(sub: Sub<Actions>): CmdType<Actions> {\n    return [sub]\n  },\n  batch<State, Actions>(...cmds: (CmdType<Actions> | CmdType<Actions>[])[]): CmdType<Actions> {\n    const _concat = Array.prototype.concat\n    return _concat.apply([], _concat.apply([], cmds))\n  },\n  map<State, Actions, SubActions>(map: (action: Actions) => SubActions, cmd: CmdType<SubActions>): CmdType<Actions> {\n    return cmd.map(sub => actions => sub(map(actions)))\n  }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/cmd.ts","import { AppProps, App } from './../index'\nimport Cmd from './../cmd'\nimport { get } from '../utils'\n\nexport default function withPersist<State, Actions>(props: {\n  store?: Storage,\n  serialize?: (data: any) => string,\n  deserialize?: (str: string) => any,\n  debounce?: number,\n  key?: string,\n} = {}): (app: App<State, Actions>) => App<State, Actions> {\n  const {\n    store = localStorage,\n    serialize = JSON.stringify,\n    deserialize = JSON.parse,\n    debounce = 50,\n    key = 'hydux-persist',\n  } = props\n  let timer\n  return (app: App<State, Actions>) => (props: AppProps<State, Actions>) => {\n    return app({\n      ...props,\n      init: () => {\n        let result = props.init()\n        if (!(result instanceof Array)) {\n          result = [result, Cmd.none]\n        }\n        const persistState = store.getItem(key)\n        if (persistState) {\n          result[0] = deserialize(persistState)\n        }\n        return [result[0], result[1]]\n      },\n      onUpdate: (data) => {\n        props.onUpdate && props.onUpdate(data)\n        timer && clearTimeout(timer)\n        const persist = () => store.setItem(key, serialize(data.nextAppState))\n        timer = setTimeout(persist, debounce)\n      },\n    })\n  }\n\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/enhancers/persist.ts"],"sourceRoot":""}